version: "1.0"
generated: "2026-02-18"

# Task status tracking for Holly Grace development.
# Statuses: pending | active | done | blocked
#
# Short form:   task_id: pending
# Long form:    task_id:
#                 status: done
#                 commit: abc1234
#                 date: 2026-02-18
#                 note: optional context
#
# This file is the single source of truth for development progress.
# Run `python -m holly.arch gantt` to regenerate Gantt charts.

tasks:
  # ── Slice 1: Phase A Spiral ────────────────────────────────
  # Step 1 — Extract
  1.1: pending
  1.2: pending
  1.3: pending
  1.4: pending
  1.5:
    status: done
    commit: b829279
    date: "2026-02-18"
    note: "SAD mermaid parser → typed AST (14 tests)"
  1.6:
    status: done
    commit: b829279
    date: "2026-02-18"
    note: "Pydantic v2 architecture.yaml schema (7 tests)"
  1.7:
    status: done
    commit: b829279
    date: "2026-02-18"
    note: "SAD AST → ArchitectureDocument pipeline (12 tests)"
  1.8:
    status: done
    commit: b829279
    date: "2026-02-18"
    note: "SourceRef linking in all models"

  # Step 2 — Registry
  2.1: pending
  2.2: pending
  2.3: pending
  2.4: pending
  2.5: pending
  2.6:
    status: done
    date: "2026-02-18"
    note: "ArchitectureRegistry singleton, thread-safe lazy init (18 tests)"
  2.7:
    status: done
    date: "2026-02-18"
    note: "get_component/get_boundary/get_icd lookups (24 tests)"
  2.8:
    status: done
    date: "2026-02-18"
    note: "Hot-reload with validation, generation counter (18 tests)"
  2.9: pending

  # Step 3 — Decorators
  3.1: pending
  3.2: pending
  3.3: pending
  3.4: pending
  3.5: pending
  3.6:
    status: done
    date: "2026-02-18"
    note: "Core decorators: @kernel_boundary, @tenant_scoped, @lane_dispatch, @mcp_tool, @eval_gated (37 tests)"
  3.7:
    status: done
    commit: 6fb886b
    date: "2026-02-18"
    note: "K1 schema validation gate, SchemaRegistry, ICD contract enforcement via @kernel_boundary (37 tests)"
  3.8: pending
  3.9: pending
  3.10: pending

  # Step 3a — Spiral Gate
  3a.1: pending
  3a.2: pending
  3a.3: pending
  3a.4: pending
  3a.5: pending
  3a.6: pending
  3a.7: pending
  3a.8:
    status: done
    date: "2026-02-18"
    note: "Full pipeline integration test: YAML → registry → decorator → K1 (13 tests)"
  3a.9: pending
  3a.10:
    status: done
    date: "2026-02-18"
    note: "K8 eval gate, PredicateRegistry, @eval_gated decorator enforcement (26 tests)"
  3a.11: pending
  3a.12:
    status: done
    date: "2026-02-18"
    note: "Spiral gate report: 3 PASS, 9 WAIVED, 0 FAIL - Slice 2 unlocked (17 tests)"

  # ── Slice 2: Phase A Backfill ───────────────────────────
  # Step 4 — Scaffold
  4.1: pending
  4.2: pending
  4.3: pending
  4.4: pending
  4.5: pending

  # Step 5 — ICD
  5.1: pending
  5.2: pending
  5.3: pending
  5.4: pending
  5.5:
    status: done
    date: "2026-02-18"
    note: "49 ICD Pydantic models, ICD_MODEL_MAP, register_all_icd_models(), enum constraints (120 tests)"
  5.6:
    status: done
    date: "2026-02-18"
    note: "49 ICDs in architecture.yaml with component mapping, protocol, SIL; registry lookups (165 tests)"
  5.7: pending
  5.8:
    status: done
    date: "2026-02-18"
    note: "ICD Schema Registry: Pydantic model resolution with TTL cache, all 49 ICDs, <1ms p99 (32 tests)"
  5.9: pending

  # Step 5a — ATAM
  5a.1: pending
  5a.2: pending
  5a.3: pending
  5a.4: pending

  # Step 6 — Validate
  6.1: pending
  6.2: pending
  6.3: pending

  # Step 7 — Scan
  7.1:
    status: done
    date: "2026-02-18"
    note: "AST scanner with per-module rules, layer→decorator mapping, component overrides, source/module/directory scanning (31 tests)"
  7.2:
    status: done
    date: "2026-02-18"
    note: "ICD-aware wrong-decorator detection: icd_schema cross-validation, ICD_MISMATCH findings, scan_full() combined pipeline (32 tests)"
  7.3: pending

  # Step 8 — Test
  8.1: pending
  8.2: pending
  8.3:
    status: done
    date: "2026-02-18"
    note: "Contract fixture generator: valid/invalid/Hypothesis strategies for all 49 ICDs (597 tests)"
  8.4: pending

  # Step 9 — Fitness Functions
  9.1: pending
  9.2:
    status: done
    date: "2026-02-18"
    note: "Architecture fitness functions: layer violations, coupling metrics, dependency depth, import graph, run_all (67 tests)"
  9.3: pending
  9.4: pending

  # Step 10 — RTM Generation
  10.1: pending
  10.2:
    status: done
    date: "2026-02-18"
    note: "RTM generator: decorator discovery, test discovery, traceability matrix, CSV export, report generation (30 tests)"
  10.3: pending

  # Step 11 — CI Gate
  11.1:
    status: done
    date: "2026-02-18"
    note: "Unified CI gate: ordered 4-stage pipeline, fail-fast, blocking/warning/info severity, GateVerdict summary (28 tests)"
  11.2: pending
  11.3:
    status: done
    date: "2026-02-18"
    note: "Phase A gate checklist: 10 items, all PASS, Phase B unlocked (25 tests)"
  11.4: pending

  # ── Slice 3: Phase B — Formal Methods & Full Kernel ─────────────
  # Step 13 — FMEA
  13.1:
    status: done
    date: "2026-02-19"
    note: "FMEA kernel invariant desynchronization: KernelContext + K1–K8, 3 failure modes each, RPN table, mitigations (0 tests — document artifact)"
  13.2: pending
  13.3: pending
  13.4: pending
  13.5: pending
  13.6: pending
  13.7: pending

  # Step 14 — TLA+
  14.1:
    status: done
    date: "2026-02-19"
    note: "TLA+ KernelContext state machine: 5 states, 8 actions, 8 safety invariants, 5 liveness properties; TLC 14 distinct states, 0 violations (0 tests — formal methods artifact)"
  14.2: pending
  14.3: pending
  14.4: pending
  14.5:
    status: done
    date: "2026-02-19"
    note: "Formal state-machine validator: KernelState/KernelEvent enums, VALID_TRANSITIONS frozenset, pure guards, validate_trace, KernelStateMachineValidator; mirrors TLA+ spec §14.1; Hypothesis property tests for determinism/purity/state-space (96 tests)"

  # Step 15 — KernelContext
  15.1: pending
  15.2: pending
  15.3: pending
  15.4:
    status: done
    date: "2026-02-19"
    note: "KernelContext async context manager: 5-state lifecycle (IDLE/ENTERING/ACTIVE/EXITING/FAULTED), pluggable gates, corr_id, exit cleanup stub; all state-machine paths end in IDLE; liveness property satisfied (41 tests)"
  15.5: pending
  15.6: pending
  15.7: pending

  # Step 16 — K1-K4 (schema, permissions, bounds, trace)
  16.1: pending
  16.2: pending
  16.3:
    status: done
    date: "2026-02-19"
    note: "k1_gate factory: Gate-protocol async adapter for KernelContext; wraps k1_validate; all failure paths end in IDLE (TLA+ EventuallyIdle); composes with other gates; property-based zero FP/FN tests (29 tests)"
  16.4:
    status: done
    date: "2026-02-19"
    note: "K2 RBAC permission gate: k2_check_permissions + k2_gate factory; PermissionRegistry singleton; RevocationCache protocol + NullRevocationCache + FailRevocationCache; JWTError/ExpiredTokenError/RevokedTokenError/PermissionDeniedError/RoleNotFoundError/RevocationCacheError; pre-decoded claims dict; fail-safe revocation deny; TLA+ liveness all paths IDLE; composes with k1_gate; property-based zero FP/FN (42 tests)"
  16.5:
    status: done
    date: "2026-02-19"
    note: "K3 resource bounds gate: k3_check_bounds + k3_gate factory; BudgetRegistry singleton; UsageTracker Protocol + InMemoryUsageTracker + FailUsageTracker; BoundsExceeded/BudgetNotFoundError/InvalidBudgetError/UsageTrackingError exceptions; per-tenant isolation (40 tests)"
  16.6:
    status: done
    date: "2026-02-19"
    note: "K4 trace injection gate: k4_inject_trace + k4_gate factory; TenantContextError; KernelContext._set_trace + tenant_id/trace_started_at slots; UUID validation; 39 tests"
  16.7: pending
  16.8: pending
  16.9:
    status: done
    date: "2026-02-19"
    note: "K1-K4 guard condition determinism: property-based tests verifying INV-4 (guards pure, no side effects); 31 tests across TestK1/K2/K3/K4Determinism + TestCrossGuardIsolation"

  # Step 17 — K5-K6 (idempotency, WAL)
  17.1: pending
  17.2: pending
  17.3:
    status: done
    date: "2026-02-19"
    note: "K5 idempotency gate: k5_generate_key (RFC 8785 + SHA-256), InMemoryIdempotencyStore, k5_gate factory; CanonicalizeError + DuplicateRequestError exceptions; jcs dependency added; 48 tests"
  17.4:
    status: done
    date: "2026-02-19"
    note: "K6 WAL gate: WALEntry dataclass, WALBackend protocol, InMemoryWALBackend, redact() (email/api_key/credit_card/ssn/phone), k6_write_entry(), k6_gate() factory; WALWriteError + WALFormatError + RedactionError exceptions; 57 tests"
  17.5: pending
  17.6: pending
  17.7:
    status: done
    commit: 2114590
    date: "2026-02-19"
    note: "K5-K6 Invariant Preservation: property-based tests for all 6 KernelContext invariants (INV-1 through INV-6); 10,000-operation master trace test; zero invariant violations; redact determinism + k5_generate_key determinism properties; 36 tests"

  # Step 18 — K7-K8 (HITL, eval)
  18.1: pending
  18.2: pending
  18.3:
    status: done
    commit: aab1673
    date: "2026-02-19"
    note: "K7 HITL gate: ApprovalRequest/HumanDecision dataclasses, ConfidenceEvaluator/ThresholdConfig/ApprovalChannel protocols, InMemoryApprovalChannel, k7_check_confidence pure guard, k7_gate factory; ConfidenceError/ApprovalTimeout/OperationRejected/ApprovalChannelError exceptions; fail-safe deny on all error paths (52 tests)"
  18.4:
    status: done
    commit: 512b861
    date: "2026-02-19"
    note: "K8 full gate factory: CELESTIAL_PREDICATE_IDS tuple (L0-L4), k8_gate() factory running all 5 Celestial predicates in strict ascending order with fail-fast on first failure; Gate protocol async adapter; EvalGateFailure/PredicateNotFoundError/EvalError fail-safe paths (38 tests)"
  18.5: pending
  18.6: pending
  18.7: pending
  18.8: pending
  18.9:
    status: done
    date: "2026-02-19"
    commit: 1c4dfe4
    note: "K7-K8 Failure Isolation: 7-class integration test suite verifying independent exception paths; _AlwaysRejectChannel, _SpyGate helpers; Hypothesis property-based tests; 0 cascade failures across all K7/K8 failure modes; AC 1-7 all covered (30 tests)"

  # Step 19 — Exceptions
  19.1: pending
  19.2: pending
  19.3: pending
  19.4: pending

  # Step 20 — Dissimilar Verification
  20.1: pending
  20.2: pending
  20.3:
    status: done
    date: "2026-02-19"
    commit: 73d40d0
    note: "Dissimilar verification channel: VerificationViolation/VerificationReport dataclasses, 8 per-entry checkers (K1-K8), 2 cross-entry checkers (tenant isolation, duplicate IDs), verify_wal_entries() API; DissimilarVerificationError added to exceptions.py; zero false negatives on injected bugs; AC 1-5 all covered (57 tests)"
  20.4: pending
  20.5:
    status: done
    date: "2026-02-19"
    commit: 5a0b56c
    note: "Dissimilar SM verifier: independent hardcoded _VALID_TRANSITIONS frozenset, ExecutionTrace/StateViolation/StateMachineReport dataclasses, TraceCollector, parse_trace(), verify_execution_traces(); zero imports from state_machine.py/context.py; _TracedKernelContext captures transient EXITING state; all injected violations detected; AC 1-2 covered (47 tests)"

  # Step 21 — SIL-3 Verification
  21.2:
    status: done
    date: "2026-02-19"
    commit: 21ee890
    note: "SIL-3 kernel verification: 58-test integration suite covering K1-K8 Behavior Spec §1.2-1.9; ≥3 Hypothesis property-based invariants per gate; AC-numbered docstrings for full traceability; Python 3.10 compat fixes for datetime.UTC (k6,k7) and StrEnum (state_machine); 58/58 pass"
  21.6:
    status: done
    date: "2026-02-19"
    note: "Phase B gate checklist: GATE_ITEMS_PHASE_B (18 items), evaluate_phase_b_gate(), render_phase_b_report(), gate-b CLI subcommand; 18 PASS, 0 FAIL - Phase C unlocked (68 tests)"

  # ── Slice 4: Phase C — Storage Layer ────────────────────────────────────
  # Step 22 — Postgres
  22.5:
    status: done
    date: "2026-02-19"
    note: "Async Postgres pool: TenantIsolatedPool (SET LOCAL RLS), SchemaManager (11 tables, 16 indexes, 10 RLS policies), GoalsRepo/AuditRepo/CheckpointsRepo/TaskStateRepo/MemoryRepo, PostgresBackend facade, _with_deadlock_retry backoff; Protocol-based abstraction; non-fatal AuditRepo+TaskStateRepo; asyncpg 0.31.0 (41 tests)"
  22.7:
    status: done
    date: "2026-02-19"
    note: "RLS boundary audit: ICD_BOUNDARY (6 specs), ICDBoundarySpec, RLSTableVerdict, RLSBoundaryReport, validate_icd_boundary_static(), audit_rls_policies() (pg_policies catalog), render_rls_boundary_report(); 10 RLS-required tables, 1 exempt (kernel_audit_log/ICD-038); cross-tenant isolation verified (70 tests)"
  # Step 23 — Partitioning
  23.3:
    status: done
    date: "2026-02-19"
    note: "Partition lifecycle manager: PartitionName (frozen/slots, from_tenant_id/parse), PartitionManager (ensure_partition, archive_partition, restore_partition, list_expired_partitions, run_archival_cycle), day_epoch_range, create_partition_ddl, PartitionNotFoundError, S3ClientProto/PartitionConnectionProto Protocols; ICD-036 (logs date+tenant), ICD-038 (kernel_audit_log date-only), 90-day TTL; Hypothesis epoch+name invariants (58 tests)"
  # Step 24 — Redis
  24.3:
    status: done
    date: "2026-02-19"
    note: "Redis module: CacheClient (ICD-033/041, tenant-namespaced keys, fail-open), QueueClient (ICD-035, LPUSH/RPOP, ZADD/ZRANGEBYSCORE cron, depth limit 10k), PubSubClient (ICD-035, publish/subscribe/get_message), StreamClient (ICD-037, XADD maxlen 1M, XRANGE), RevocationCache (ICD-049, fail-open), CircuitBreaker (threshold 3, recovery 30s, CLOSED/OPEN/HALF_OPEN), RedisBackend facade (from_client factory), tenant_key/queue_key/stream_key/revocation_key helpers (61 tests)"
